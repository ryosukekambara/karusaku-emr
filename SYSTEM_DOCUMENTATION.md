# ğŸ“Š ã‚«ãƒ«ã‚µã‚¯EMRã‚·ã‚¹ãƒ†ãƒ  - å®Œå…¨ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

**æœ€çµ‚æ›´æ–°**: 2025å¹´10æœˆ22æ—¥ 21:00
**æœ€æ–°ã‚³ãƒŸãƒƒãƒˆ**: `93def89`
**ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹**: ğŸŸ¡ ã‚µã‚¤ãƒ‰ãƒãƒ¼å•é¡Œèª¿æŸ»ä¸­

---

## ğŸ“‹ ç›®æ¬¡

1. [ã‚·ã‚¹ãƒ†ãƒ æ¦‚è¦](#ã‚·ã‚¹ãƒ†ãƒ æ¦‚è¦)
2. [æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯](#æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯)
3. [ãƒ•ã‚¡ã‚¤ãƒ«æ§‹æˆ](#ãƒ•ã‚¡ã‚¤ãƒ«æ§‹æˆ)
4. [å®Œäº†ã—ã¦ã„ã‚‹æ©Ÿèƒ½](#å®Œäº†ã—ã¦ã„ã‚‹æ©Ÿèƒ½)
5. [æœªå®Œäº†ãƒ»å•é¡Œã®ã‚ã‚‹æ©Ÿèƒ½](#æœªå®Œäº†å•é¡Œã®ã‚ã‚‹æ©Ÿèƒ½)
6. [ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ§‹é€ ](#ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ§‹é€ )
7. [ãƒ‡ãƒ—ãƒ­ã‚¤ç’°å¢ƒ](#ãƒ‡ãƒ—ãƒ­ã‚¤ç’°å¢ƒ)
8. [ã‚·ã‚¹ãƒ†ãƒ ãƒ•ãƒ­ãƒ¼](#ã‚·ã‚¹ãƒ†ãƒ ãƒ•ãƒ­ãƒ¼)

---

## ğŸ¯ ã‚·ã‚¹ãƒ†ãƒ æ¦‚è¦

é¼ç¸é™¢å‘ã‘ã®é›»å­ã‚«ãƒ«ãƒ†ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ ï¼ˆEMRï¼‰ã€‚æ‚£è€…ç®¡ç†ã€ã‚«ãƒ«ãƒ†è¨˜éŒ²ã€æ–½è¡“è¨˜éŒ²ã€ãƒ¬ãƒãƒ¼ãƒˆæ©Ÿèƒ½ã‚’æä¾›ã€‚

### ä¸»è¦æ©Ÿèƒ½
- âœ… èªè¨¼ãƒ»æ¨©é™ç®¡ç†ï¼ˆJWTï¼‰
- âœ… æ‚£è€…ç®¡ç†ï¼ˆCRUDå®Œå…¨å®Ÿè£…ï¼‰
- âœ… ã‚«ãƒ«ãƒ†ç®¡ç†ï¼ˆå†™çœŸæ·»ä»˜å¯¾å¿œï¼‰
- âœ… æ–½è¡“è¨˜éŒ²ãƒ»ãƒ¡ãƒ‹ãƒ¥ãƒ¼ç®¡ç†
- âœ… æ–½è¡“è€…ç®¡ç†
- âš ï¸ ã‚µã‚¤ãƒ‰ãƒãƒ¼UIï¼ˆç¾åœ¨å•é¡Œèª¿æŸ»ä¸­ï¼‰
- âŒ äºˆç´„ç®¡ç†ï¼ˆæœªå®Ÿè£…ï¼‰
- âŒ LINEé€£æºï¼ˆæœªå®Ÿè£…ï¼‰

---

## ğŸ›  æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯

### ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰
| æŠ€è¡“ | ãƒãƒ¼ã‚¸ãƒ§ãƒ³ | ç”¨é€” |
|------|-----------|------|
| React | 18.2.0 | UIãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ |
| TypeScript | 4.7.4 | å‹å®‰å…¨æ€§ |
| React Router | 6.3.0 | ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚° |
| ~~react-pro-sidebar~~ | ~~1.1.0~~ | âš ï¸ å‰Šé™¤æ¸ˆã¿ï¼ˆã‚«ã‚¹ã‚¿ãƒ å®Ÿè£…ã«å¤‰æ›´ï¼‰ |
| lucide-react | 0.544.0 | ã‚¢ã‚¤ã‚³ãƒ³ |

### ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰
| æŠ€è¡“ | ãƒãƒ¼ã‚¸ãƒ§ãƒ³ | ç”¨é€” |
|------|-----------|------|
| Node.js + Express | 5.1.0 | APIã‚µãƒ¼ãƒãƒ¼ |
| PostgreSQL | 15 | ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ |
| pg | 8.11.3 | PostgreSQLæ¥ç¶š |
| bcryptjs | 3.0.2 | ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãƒãƒƒã‚·ãƒ¥åŒ– |
| jsonwebtoken | 9.0.2 | JWTèªè¨¼ |
| cors | 2.8.5 | CORSå¯¾å¿œ |
| helmet | 7.0.0 | ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ˜ãƒƒãƒ€ãƒ¼ |

### ã‚¤ãƒ³ãƒ•ãƒ©
| ã‚µãƒ¼ãƒ“ã‚¹ | ç”¨é€” | URL |
|---------|------|-----|
| Vercel | ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ãƒ›ã‚¹ãƒ†ã‚£ãƒ³ã‚° | https://karusaku-system.vercel.app |
| Render | ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ãƒ»DBï¼ˆç„¡æ–™ãƒ—ãƒ©ãƒ³ï¼‰ | https://karusaku-emr-backend.onrender.com |
| GitHub | ã‚½ãƒ¼ã‚¹ç®¡ç† | https://github.com/ryosukekambara/karusaku-emr |

---

## ğŸ“ ãƒ•ã‚¡ã‚¤ãƒ«æ§‹æˆ

```
karusaku-emr/
â”œâ”€â”€ .gitignore
â”œâ”€â”€ upload-screenshot.sh           # ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ãƒ„ãƒ¼ãƒ«
â”œâ”€â”€ screenshots/                   # ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆä¿å­˜å…ˆ
â”‚   â””â”€â”€ README.md
â”‚
â”œâ”€â”€ server/                        # ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰
â”‚   â”œâ”€â”€ index.js                   # ãƒ¡ã‚¤ãƒ³ã‚µãƒ¼ãƒãƒ¼ï¼ˆRenderæœ¬ç•ªç”¨ï¼‰
â”‚   â”œâ”€â”€ api-server.js              # ãƒ­ãƒ¼ã‚«ãƒ«é–‹ç™ºç”¨ã‚µãƒ¼ãƒãƒ¼
â”‚   â”œâ”€â”€ database.js                # ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶šãƒ»åˆæœŸåŒ–
â”‚   â”œâ”€â”€ package.json               # ä¾å­˜é–¢ä¿‚
â”‚   â””â”€â”€ .env                       # ç’°å¢ƒå¤‰æ•°ï¼ˆGitã«ã¯å«ã¾ãªã„ï¼‰
â”‚
â””â”€â”€ client/                        # ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰
    â”œâ”€â”€ package.json               # ä¾å­˜é–¢ä¿‚
    â”‚   â”œâ”€â”€ react: ^18.2.0
    â”‚   â”œâ”€â”€ typescript: ^4.7.4
    â”‚   â”œâ”€â”€ react-router-dom: ^6.3.0
    â”‚   â””â”€â”€ lucide-react: ^0.544.0
    â”‚
    â”œâ”€â”€ vercel.json                # Vercelè¨­å®š
    â”‚
    â”œâ”€â”€ public/
    â”‚   â”œâ”€â”€ index.html
    â”‚   â””â”€â”€ _redirects            # SPAç”¨ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆ
    â”‚
    â””â”€â”€ src/
        â”œâ”€â”€ index.tsx              # ã‚¨ãƒ³ãƒˆãƒªãƒ¼ãƒã‚¤ãƒ³ãƒˆ
        â”œâ”€â”€ App.tsx                # ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
        â”‚   â”œâ”€â”€ æœ€æ–°: ã‚«ã‚¹ã‚¿ãƒ ã‚µã‚¤ãƒ‰ãƒãƒ¼å®Ÿè£…
        â”‚   â”œâ”€â”€ è¡Œæ•°: ~380è¡Œ
        â”‚   â””â”€â”€ çŠ¶æ…‹ç®¡ç†: useState, useEffect
        â”‚
        â”œâ”€â”€ App.css                # ã‚°ãƒ­ãƒ¼ãƒãƒ«ã‚¹ã‚¿ã‚¤ãƒ«
        â”‚
        â”œâ”€â”€ config/
        â”‚   â””â”€â”€ api.ts             # APIè¨­å®š
        â”‚       â”œâ”€â”€ API_BASE_URL: 'https://karusaku-emr-backend.onrender.com'
        â”‚       â”œâ”€â”€ API_ENDPOINTS: å„ç¨®ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆå®šç¾©
        â”‚       â””â”€â”€ getAuthHeaders(): JWTèªè¨¼ãƒ˜ãƒƒãƒ€ãƒ¼ç”Ÿæˆ
        â”‚
        â”œâ”€â”€ utils/
        â”‚   â””â”€â”€ security.ts        # ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç®¡ç†
        â”‚       â”œâ”€â”€ sessionManager: ã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç†
        â”‚       â”œâ”€â”€ isSessionValid(): ã‚»ãƒƒã‚·ãƒ§ãƒ³æœ‰åŠ¹æ€§ãƒã‚§ãƒƒã‚¯
        â”‚       â””â”€â”€ shouldAutoLogout(): è‡ªå‹•ãƒ­ã‚°ã‚¢ã‚¦ãƒˆåˆ¤å®š
        â”‚
        â””â”€â”€ components/            # æ©Ÿèƒ½ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
            â”œâ”€â”€ Login.tsx          # ãƒ­ã‚°ã‚¤ãƒ³ç”»é¢
            â”œâ”€â”€ Dashboard.tsx      # ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰
            â”‚
            â”œâ”€â”€ PatientList.tsx    # æ‚£è€…ä¸€è¦§
            â”œâ”€â”€ AddPatient.tsx     # æ‚£è€…ç™»éŒ²
            â”œâ”€â”€ EditPatient.tsx    # æ‚£è€…ç·¨é›†
            â”œâ”€â”€ PatientDetail.tsx  # æ‚£è€…è©³ç´°
            â”‚
            â”œâ”€â”€ MedicalRecordList.tsx   # ã‚«ãƒ«ãƒ†ä¸€è¦§
            â”œâ”€â”€ AddMedicalRecord.tsx    # ã‚«ãƒ«ãƒ†ä½œæˆ
            â”œâ”€â”€ EditMedicalRecord.tsx   # ã‚«ãƒ«ãƒ†ç·¨é›†
            â”‚
            â”œâ”€â”€ TreatmentRecord.tsx     # æ–½è¡“è¨˜éŒ²
            â”œâ”€â”€ MenuManagement.tsx      # æ–½è¡“ãƒ¡ãƒ‹ãƒ¥ãƒ¼ç®¡ç†
            â”‚
            â”œâ”€â”€ TherapistList.tsx       # æ–½è¡“è€…ä¸€è¦§
            â”œâ”€â”€ AddTherapist.tsx        # æ–½è¡“è€…ç™»éŒ²
            â”œâ”€â”€ EditTherapist.tsx       # æ–½è¡“è€…ç·¨é›†
            â”‚
            â”œâ”€â”€ ReceiptManagement.tsx   # é ˜åæ›¸ç®¡ç†
            â”œâ”€â”€ Reports.tsx             # ãƒ¬ãƒãƒ¼ãƒˆæ©Ÿèƒ½
            â”œâ”€â”€ Settings.tsx            # è¨­å®šç”»é¢
            â”œâ”€â”€ BackupManagement.tsx    # ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ç®¡ç†
            â”‚
            â”œâ”€â”€ ClinicManagement.tsx     # é™¢ç®¡ç†
            â”œâ”€â”€ EmployeeManagement.tsx   # å¾“æ¥­å“¡ç®¡ç†
            â”œâ”€â”€ WageCalculation.tsx      # çµ¦ä¸è¨ˆç®—
            â”œâ”€â”€ WorkflowManagement.tsx   # ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ç®¡ç†
            â”œâ”€â”€ MessageTemplateEditor.tsx # ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ
            â””â”€â”€ LineBotManagement.tsx    # LINE Botç®¡ç†
```

---

## âœ… å®Œäº†ã—ã¦ã„ã‚‹æ©Ÿèƒ½

### 1. èªè¨¼ã‚·ã‚¹ãƒ†ãƒ  âœ…

**å ´æ‰€**:
- ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰: `client/src/components/Login.tsx`
- API: `server/index.js` (63-100è¡Œç›®)
- ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£: `client/src/utils/security.ts`

**å®Ÿè£…å†…å®¹**:
```javascript
// ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰: server/index.js
app.post('/api/auth/login', async (req, res) => {
  const { username, password } = req.body;

  try {
    const result = await pool.query(
      'SELECT * FROM users WHERE username = $1',
      [username]
    );

    if (result.rows.length === 0 ||
        !await bcrypt.compare(password, result.rows[0].password)) {
      return res.status(401).json({ error: 'èªè¨¼å¤±æ•—' });
    }

    const user = result.rows[0];
    const token = jwt.sign(
      { id: user.id, username: user.username, role: user.role },
      process.env.JWT_SECRET,
      { expiresIn: '24h' }
    );

    res.json({ token, user });
  } catch (error) {
    res.status(500).json({ error: 'ã‚µãƒ¼ãƒãƒ¼ã‚¨ãƒ©ãƒ¼' });
  }
});
```

**ãƒ•ãƒ­ãƒ¼**:
```
1. ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒãƒ­ã‚°ã‚¤ãƒ³ç”»é¢ã§admin/admin123ã‚’å…¥åŠ›
   â†“
2. POST /api/auth/login
   â†’ ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã§ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰æ¤œè¨¼ï¼ˆbcryptï¼‰
   â†“
3. JWTç”Ÿæˆï¼ˆæœ‰åŠ¹æœŸé™24æ™‚é–“ï¼‰
   â†“
4. ãƒˆãƒ¼ã‚¯ãƒ³ã‚’localStorageã«ä¿å­˜
   â†“
5. ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã«ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆ
```

**ãƒ†ã‚¹ãƒˆã‚¢ã‚«ã‚¦ãƒ³ãƒˆ**:
- ç®¡ç†è€…: `admin` / `admin123`
- ã‚¹ã‚¿ãƒƒãƒ•: `staff` / `staff123`

---

### 2. æ‚£è€…ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ  âœ…

#### A. æ‚£è€…ä¸€è¦§ (`/patients`)

**å ´æ‰€**: `client/src/components/PatientList.tsx`

**API**: `GET /api/patients`

```javascript
// server/index.js (104-110è¡Œç›®)
app.get('/api/patients', authenticateToken, async (req, res) => {
  const result = await pool.query(
    'SELECT * FROM patients ORDER BY created_at DESC'
  );
  res.json(result.rows);
});
```

**æ©Ÿèƒ½**:
- å…¨æ‚£è€…è¡¨ç¤ºï¼ˆãƒ†ãƒ¼ãƒ–ãƒ«å½¢å¼ï¼‰
- æ¤œç´¢ãƒ»ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°
- è©³ç´°ç”»é¢ã¸ã®é·ç§»

---

#### B. æ‚£è€…ç™»éŒ² (`/patients/add`)

**å ´æ‰€**: `client/src/components/AddPatient.tsx`

**API**:
- `GET /api/patients/max-id` - æœ€å¤§IDå–å¾—
- `POST /api/patients` - æ‚£è€…ç™»éŒ²

**ãƒ•ãƒ­ãƒ¼**:
```
1. ç”»é¢è¡¨ç¤ºæ™‚ã«useEffectã§æœ€å¤§IDå–å¾—
   â†“
   GET /api/patients/max-id
   â†’ ç¾åœ¨ã®æœ€å¤§IDï¼ˆä¾‹: 1233ï¼‰
   â†“
2. æ¬¡ã®IDã‚’è‡ªå‹•è¡¨ç¤ºï¼ˆ1234ï¼‰
   â†“
3. ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒæ‚£è€…æƒ…å ±ã‚’å…¥åŠ›
   - åå‰ã€ãµã‚ŠãŒãª
   - ç”Ÿå¹´æœˆæ—¥ã€æ€§åˆ¥
   - é›»è©±ç•ªå·ã€ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹
   - ä½æ‰€ã€ç·Šæ€¥é€£çµ¡å…ˆ
   - æ—¢å¾€æ­´ã€ã‚¢ãƒ¬ãƒ«ã‚®ãƒ¼
   â†“
4. ç™»éŒ²ãƒœã‚¿ãƒ³ã‚¯ãƒªãƒƒã‚¯
   â†“
   POST /api/patients
   â†’ PostgreSQLã«ä¿å­˜
   â†“
5. æ‚£è€…ä¸€è¦§ã«ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆ
```

**ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰å®Ÿè£…**:
```javascript
// æœ€å¤§IDå–å¾—
app.get('/api/patients/max-id', authenticateToken, async (req, res) => {
  const result = await pool.query('SELECT MAX(id) as max_id FROM patients');
  res.json({ maxId: result.rows[0].max_id || 0 });
});

// æ‚£è€…ç™»éŒ²
app.post('/api/patients', authenticateToken, async (req, res) => {
  const { name, kana, birth_date, gender, phone, email,
          address, emergency_contact, medical_history, allergies } = req.body;

  const result = await pool.query(
    `INSERT INTO patients (name, kana, birth_date, gender, phone, email,
                           address, emergency_contact, medical_history, allergies)
     VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING id`,
    [name, kana, birth_date, gender, phone, email,
     address, emergency_contact, medical_history, allergies]
  );

  res.json({ id: result.rows[0].id, message: 'ç™»éŒ²æˆåŠŸ' });
});
```

---

#### C. æ‚£è€…è©³ç´° (`/patients/:id`)

**å ´æ‰€**: `client/src/components/PatientDetail.tsx`

**API**: `GET /api/patients/:id`

**æ©Ÿèƒ½**:
- æ‚£è€…åŸºæœ¬æƒ…å ±è¡¨ç¤º
- ã‚«ãƒ«ãƒ†å±¥æ­´ä¸€è¦§
- ç·¨é›†ãƒ»å‰Šé™¤æ©Ÿèƒ½

---

#### D. æ‚£è€…ç·¨é›† (`/patients/:id/edit`)

**å ´æ‰€**: `client/src/components/EditPatient.tsx`

**API**: `PUT /api/patients/:id`

---

### 3. ã‚«ãƒ«ãƒ†ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ  âœ…

#### A. ã‚«ãƒ«ãƒ†ä¸€è¦§ (`/medical-records`)

**å ´æ‰€**: `client/src/components/MedicalRecordList.tsx`

**API**: `GET /api/medical-records`

```javascript
// server/index.js (151-167è¡Œç›®)
app.get('/api/medical-records', authenticateToken, async (req, res) => {
  const result = await pool.query(`
    SELECT mr.*, p.name as patient_name, u.name as staff_name
    FROM medical_records mr
    JOIN patients p ON mr.patient_id = p.id
    JOIN users u ON mr.staff_id = u.id
    ORDER BY mr.treatment_date DESC
  `);
  res.json(result.rows);
});
```

**æ©Ÿèƒ½**:
- å…¨ã‚«ãƒ«ãƒ†è¡¨ç¤ºï¼ˆæ‚£è€…åãƒ»æ–½è¡“è€…åä»˜ãï¼‰
- æ—¥ä»˜é †ã‚½ãƒ¼ãƒˆ
- æ¤œç´¢ãƒ»ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°

---

#### B. ã‚«ãƒ«ãƒ†ä½œæˆ (`/patients/:id/records/add`)

**å ´æ‰€**: `client/src/components/AddMedicalRecord.tsx`

**API**: `POST /api/medical-records`

**æ©Ÿèƒ½**:
- æ–½è¡“å†…å®¹å…¥åŠ›
- ç—‡çŠ¶ãƒ»è¨ºæ–­è¨˜éŒ²
- å†™çœŸæ·»ä»˜ï¼ˆBase64å½¢å¼ï¼‰
- æ‰€è¦‹ãƒ»æ¬¡å›äºˆå®š

**ãƒ•ãƒ­ãƒ¼**:
```
1. æ‚£è€…è©³ç´°ç”»é¢ã‹ã‚‰ã€Œã‚«ãƒ«ãƒ†ä½œæˆã€
   â†“
2. æ–½è¡“æƒ…å ±å…¥åŠ›
   - æ–½è¡“æ—¥
   - æ–½è¡“ç¨®é¡
   - ç—‡çŠ¶ãƒ»è¨ºæ–­
   - æ–½è¡“å†…å®¹
   - å‚™è€ƒ
   â†“
3. å†™çœŸæ·»ä»˜ï¼ˆä»»æ„ï¼‰
   â†’ ãƒ•ã‚¡ã‚¤ãƒ«é¸æŠ
   â†’ Base64å¤‰æ›
   â†’ æœ€å¤§ã‚µã‚¤ã‚º: ç´„2MB
   â†“
4. ç™»éŒ²å®Ÿè¡Œ
   â†“
   POST /api/medical-records
   â†’ PostgreSQLã«ä¿å­˜
   â†“
5. æ‚£è€…è©³ç´°ç”»é¢ã«æˆ»ã‚‹
```

âš ï¸ **æ³¨æ„**: å†™çœŸã¯Base64å½¢å¼ã§PostgreSQLã«ç›´æ¥ä¿å­˜ï¼ˆ1æšç´„2MBï¼‰

---

#### C. ã‚«ãƒ«ãƒ†ç·¨é›† (`/medical-records/:id/edit`)

**å ´æ‰€**: `client/src/components/EditMedicalRecord.tsx`

**API**: `PUT /api/medical-records/:id`

---

### 4. æ–½è¡“è¨˜éŒ²ã‚·ã‚¹ãƒ†ãƒ  âœ…

**å ´æ‰€**: `client/src/components/TreatmentRecord.tsx`

**æ©Ÿèƒ½**:
- æ–½è¡“ãƒ¡ãƒ‹ãƒ¥ãƒ¼é¸æŠ
- æ–½è¡“æ™‚é–“è¨˜éŒ²
- æ–½è¡“è€…é¸æŠ
- æ–™é‡‘è‡ªå‹•è¨ˆç®—

---

### 5. æ–½è¡“ãƒ¡ãƒ‹ãƒ¥ãƒ¼ç®¡ç† âœ…

**å ´æ‰€**: `client/src/components/MenuManagement.tsx`

**æ©Ÿèƒ½**:
- ãƒ¡ãƒ‹ãƒ¥ãƒ¼CRUD
- æ–™é‡‘è¨­å®š
- ã‚«ãƒ†ã‚´ãƒªç®¡ç†
- æ–½è¡“æ™‚é–“è¨­å®š

---

### 6. æ–½è¡“è€…ç®¡ç† âœ…

**å ´æ‰€**:
- ä¸€è¦§: `client/src/components/TherapistList.tsx`
- ç™»éŒ²: `client/src/components/AddTherapist.tsx`
- ç·¨é›†: `client/src/components/EditTherapist.tsx`

**æ©Ÿèƒ½**:
- æ–½è¡“è€…ç™»éŒ²
- ã‚¹ã‚­ãƒ«ãƒ»è³‡æ ¼ç®¡ç†
- å‹¤å‹™çŠ¶æ³ç®¡ç†

---

## âŒ æœªå®Œäº†ãƒ»å•é¡Œã®ã‚ã‚‹æ©Ÿèƒ½

### 1. ã‚µã‚¤ãƒ‰ãƒãƒ¼UIå•é¡Œ ğŸ”´ **æœ€å„ªå…ˆãƒ»ç·Šæ€¥**

**ç¾åœ¨ã®çŠ¶æ³**: 2025/10/22 21:00æ™‚ç‚¹

#### å•é¡Œ

1. âœ… **ã‚³ãƒ¼ãƒ‰**: æœ€æ–°ç‰ˆã«æ›´æ–°æ¸ˆã¿ï¼ˆ`93def89`ï¼‰
   - `if (!sidebarOpen) return null;` å®Ÿè£…æ¸ˆã¿
   - react-pro-sidebarå®Œå…¨å‰Šé™¤
   - ã‚«ã‚¹ã‚¿ãƒ ã‚µã‚¤ãƒ‰ãƒãƒ¼å®Ÿè£…

2. âœ… **GitHub**: æ­£ã—ã„ã‚³ãƒ¼ãƒ‰ãŒã‚³ãƒŸãƒƒãƒˆæ¸ˆã¿

3. âœ… **Vercel**: æœ€æ–°ã‚³ãƒ¼ãƒ‰ã‚’ãƒ“ãƒ«ãƒ‰æ¸ˆã¿
   - ãƒ“ãƒ«ãƒ‰ãƒ•ã‚¡ã‚¤ãƒ«: `main.29d22dc6.js`
   - ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚¯ãƒªã‚¢æ¸ˆã¿

4. âŒ **ãƒ–ãƒ©ã‚¦ã‚¶**: å¤ã„ãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿è¾¼ã‚“ã§ã„ã‚‹
   - èª­ã¿è¾¼ã¿ä¸­: `main.a0be573d.js`ï¼ˆå¤ã„ï¼‰
   - æœŸå¾…: `main.29d22dc6.js`ï¼ˆæ–°ã—ã„ï¼‰

#### ç¢ºèªæ¸ˆã¿ã®äº‹å®Ÿ

```javascript
// ãƒ–ãƒ©ã‚¦ã‚¶ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã§ã®ç¢ºèªçµæœ
const sidebar = document.querySelector('.sidebar');
// â†’ Sidebar exists: true
// â†’ Sidebar HTML: <aside data-testid="ps-sidebar-root-test-id" ... class="ps-sidebar-root ps-broken sidebar"

// ã“ã‚Œã¯react-pro-sidebarã®HTMLï¼ˆå¤ã„ï¼‰
// æ–°ã—ã„ã‚³ãƒ¼ãƒ‰ã§ã¯<div>ã‚’ä½¿ã†ã¯ãš
```

#### åŸå› ä»®èª¬

1. **index.htmlãŒå¤ã„**: Vercelã®ãƒ‡ãƒ—ãƒ­ã‚¤ã§index.htmlãŒæ›´æ–°ã•ã‚Œã¦ã„ãªã„
2. **è¤‡æ•°ã®ãƒ‰ãƒ¡ã‚¤ãƒ³**: åˆ¥ã®ãƒ‰ãƒ¡ã‚¤ãƒ³ãŒå¤ã„ã¾ã¾ãƒ‡ãƒ—ãƒ­ã‚¤ã•ã‚Œã¦ã„ã‚‹
3. **Vercelã®ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°å•é¡Œ**: SPAã®ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°è¨­å®šãŒå½±éŸ¿

#### æ¬¡ã«ç¢ºèªã™ã¹ãã“ã¨

1. `https://karusaku-system.vercel.app` ã®HTMLç›´æ¥ç¢ºèª
2. `https://karusaku-system.vercel.app/static/js/main.29d22dc6.js` ãŒå­˜åœ¨ã™ã‚‹ã‹
3. Vercelã®ä»–ã®ãƒ‰ãƒ¡ã‚¤ãƒ³è¨­å®šç¢ºèª

---

### 2. äºˆç´„ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ  ğŸŸ¡ **æœªå®Ÿè£…**

**å„ªå…ˆåº¦**: é«˜

**å¿…è¦ãªãƒ†ãƒ¼ãƒ–ãƒ«**:
```sql
CREATE TABLE appointments (
  id SERIAL PRIMARY KEY,
  patient_id INTEGER REFERENCES patients(id),
  appointment_date DATE NOT NULL,
  appointment_time TIME NOT NULL,
  therapist_id INTEGER REFERENCES therapists(id),
  status VARCHAR(50) DEFAULT 'scheduled',
  notes TEXT,
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

**å¿…è¦ãªæ©Ÿèƒ½**:
- äºˆç´„ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼è¡¨ç¤º
- äºˆç´„ä½œæˆãƒ»ç·¨é›†ãƒ»ã‚­ãƒ£ãƒ³ã‚»ãƒ«
- æ–½è¡“è€…åˆ¥ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«
- ç©ºãæ™‚é–“æ¤œç´¢

---

### 3. ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹å®¹é‡å•é¡Œ ğŸŸ¡

**ç¾çŠ¶**:
- å†™çœŸ1æš: ç´„2MBï¼ˆBase64å½¢å¼ï¼‰
- DBå®¹é‡åˆ¶é™: 1GBï¼ˆRenderç„¡æ–™ãƒ—ãƒ©ãƒ³ï¼‰
- é™ç•Œ: ç´„500æš

**è§£æ±ºç­–**:
1. ç”»åƒåœ§ç¸®ï¼ˆsharpä½¿ç”¨ï¼‰
2. å¤–éƒ¨ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ï¼ˆS3ã€Cloudinaryï¼‰
3. æœ‰æ–™ãƒ—ãƒ©ãƒ³

---

### 4. ã‚µãƒ¼ãƒ“ã‚¹ã‚¹ãƒªãƒ¼ãƒ—å•é¡Œ ğŸŸ 

**å•é¡Œ**: 15åˆ†ã‚¢ã‚¯ã‚»ã‚¹ãªã—ã§ã‚¹ãƒªãƒ¼ãƒ—
- èµ·å‹•ã«30ç§’-1åˆ†ã‹ã‹ã‚‹
- è¨ªå•å…ˆã§ã®åˆå›ã‚¢ã‚¯ã‚»ã‚¹ãŒé…ã„

**è§£æ±ºç­–**: UptimeRobotè¨­å®š
- ç›£è¦–URL: `https://karusaku-emr-backend.onrender.com/api/health`
- é–“éš”: 5åˆ†

---

### 5. LINEé€£æº ğŸŸ¢ **æœªå®Ÿè£…**

**å„ªå…ˆåº¦**: ä½

**å¿…è¦ãªæ©Ÿèƒ½**:
- äºˆç´„é€šçŸ¥
- ãƒªãƒã‚¤ãƒ³ãƒ€ãƒ¼é€ä¿¡
- è‡ªå‹•å¿œç­”

---

## ğŸ—„ï¸ ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ§‹é€ 

### ERDæ¦‚è¦

```
users (ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ»æ–½è¡“è€…)
  â†“ staff_id
medical_records (ã‚«ãƒ«ãƒ†) â† patient_id â† patients (æ‚£è€…)
```

### usersãƒ†ãƒ¼ãƒ–ãƒ«ï¼ˆèªè¨¼ç”¨ï¼‰

```sql
CREATE TABLE users (
  id SERIAL PRIMARY KEY,
  username VARCHAR(255) UNIQUE NOT NULL,
  password VARCHAR(255) NOT NULL,      -- bcryptãƒãƒƒã‚·ãƒ¥
  name VARCHAR(255) NOT NULL,
  role VARCHAR(50) NOT NULL,           -- 'master' or 'staff'
  department VARCHAR(100),
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

### patientsãƒ†ãƒ¼ãƒ–ãƒ«ï¼ˆæ‚£è€…æƒ…å ±ï¼‰

```sql
CREATE TABLE patients (
  id SERIAL PRIMARY KEY,
  name VARCHAR(255) NOT NULL,
  kana VARCHAR(255),
  birth_date DATE,
  gender VARCHAR(50),
  phone VARCHAR(50),
  email VARCHAR(255),
  address TEXT,
  emergency_contact VARCHAR(255),
  medical_history TEXT,
  allergies TEXT,
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

### medical_recordsãƒ†ãƒ¼ãƒ–ãƒ«ï¼ˆã‚«ãƒ«ãƒ†ï¼‰

```sql
CREATE TABLE medical_records (
  id SERIAL PRIMARY KEY,
  patient_id INTEGER REFERENCES patients(id),
  staff_id INTEGER REFERENCES users(id),
  treatment_date DATE NOT NULL,
  treatment_type VARCHAR(100),
  symptoms TEXT,
  diagnosis TEXT,
  treatment_content TEXT,
  notes TEXT,
  photo TEXT,                          -- Base64å½¢å¼ï¼ˆç´„2MB/æšï¼‰
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

---

## ğŸš€ ãƒ‡ãƒ—ãƒ­ã‚¤ç’°å¢ƒ

### ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ï¼ˆVercelï¼‰

| é …ç›® | å€¤ |
|------|-----|
| URL | https://karusaku-system.vercel.app |
| ãƒ“ãƒ«ãƒ‰ã‚³ãƒãƒ³ãƒ‰ | `npm run build` |
| å‡ºåŠ›ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª | `build` |
| ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ | create-react-app |
| Node.js | 18.x |
| è‡ªå‹•ãƒ‡ãƒ—ãƒ­ã‚¤ | mainãƒ–ãƒ©ãƒ³ãƒã¸ã®pushæ™‚ |

**æœ€æ–°ãƒ‡ãƒ—ãƒ­ã‚¤**:
- ã‚³ãƒŸãƒƒãƒˆ: `93def89`
- æ™‚åˆ»: 2025/10/22 21:08
- ãƒ“ãƒ«ãƒ‰æ™‚é–“: 46ç§’
- ãƒ“ãƒ«ãƒ‰ãƒ•ã‚¡ã‚¤ãƒ«: `main.29d22dc6.js`
- ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹: âœ… Ready

### ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ï¼ˆRenderï¼‰

| é …ç›® | å€¤ |
|------|-----|
| URL | https://karusaku-emr-backend.onrender.com |
| ã‚¿ã‚¤ãƒ— | Web Service |
| ãƒ“ãƒ«ãƒ‰ã‚³ãƒãƒ³ãƒ‰ | `npm install` |
| èµ·å‹•ã‚³ãƒãƒ³ãƒ‰ | `node index.js` |
| ãƒ—ãƒ©ãƒ³ | Free |
| ãƒªãƒ¼ã‚¸ãƒ§ãƒ³ | Oregon (US West) |
| ã‚¹ãƒªãƒ¼ãƒ— | 15åˆ†ç„¡é€šä¿¡ã§è‡ªå‹•ã‚¹ãƒªãƒ¼ãƒ— |

### ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ï¼ˆRender PostgreSQLï¼‰

| é …ç›® | å€¤ |
|------|-----|
| ã‚¿ã‚¤ãƒ— | PostgreSQL 15 |
| ãƒ—ãƒ©ãƒ³ | Free |
| å®¹é‡ | 1GB |
| ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ— | ãªã—ï¼ˆç„¡æ–™ãƒ—ãƒ©ãƒ³ï¼‰ |
| æ¥ç¶šæ–¹å¼ | ç’°å¢ƒå¤‰æ•°ï¼ˆDATABASE_URLï¼‰ |

---

## ğŸ”„ ã‚·ã‚¹ãƒ†ãƒ ãƒ•ãƒ­ãƒ¼

### å…¨ä½“ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

```
[ãƒ–ãƒ©ã‚¦ã‚¶]
    â†“ HTTPS
[Vercel - React SPA]
    â†“ APIå‘¼ã³å‡ºã—ï¼ˆJWTä»˜ãï¼‰
[Render - Express API]
    â†“ SQL
[Render - PostgreSQL]
```

### èªè¨¼ãƒ•ãƒ­ãƒ¼ï¼ˆå®Œäº†ï¼‰âœ…

```
1. ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒãƒ­ã‚°ã‚¤ãƒ³ç”»é¢ã§admin/admin123ã‚’å…¥åŠ›
   Location: client/src/components/Login.tsx
   â†“
2. ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ãŒAPIã‚³ãƒ¼ãƒ«
   POST https://karusaku-emr-backend.onrender.com/api/auth/login
   Body: { username: "admin", password: "admin123" }
   â†“
3. ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã§èªè¨¼å‡¦ç†
   Location: server/index.js (63-100è¡Œç›®)
   - ãƒ¦ãƒ¼ã‚¶ãƒ¼æ¤œç´¢: SELECT * FROM users WHERE username = $1
   - ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰æ¤œè¨¼: bcrypt.compare(password, hash)
   â†“
4. JWTç”Ÿæˆ
   jwt.sign({ id, username, role }, JWT_SECRET, { expiresIn: '24h' })
   â†“
5. ãƒˆãƒ¼ã‚¯ãƒ³è¿”å´
   Response: { token: "eyJhbGc...", user: { username, name, role } }
   â†“
6. ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã§ä¿å­˜
   localStorage.setItem('token', data.token)
   localStorage.setItem('user', JSON.stringify(data.user))
   â†“
7. ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã«ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆ
   navigate('/dashboard')
```

### æ‚£è€…ç™»éŒ²ãƒ•ãƒ­ãƒ¼ï¼ˆå®Œäº†ï¼‰âœ…

```
1. ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã‹ã‚‰ã€Œæ–°è¦æ‚£è€…ç™»éŒ²ã€ã‚’ã‚¯ãƒªãƒƒã‚¯
   Location: client/src/components/Dashboard.tsx
   â†“
2. æ‚£è€…ç™»éŒ²ç”»é¢è¡¨ç¤º
   Location: client/src/components/AddPatient.tsx
   URL: /patients/add
   â†“
3. useEffectã§æœ€å¤§IDå–å¾—
   GET /api/patients/max-id
   Header: Authorization: Bearer <token>
   â†“
4. ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã§æœ€å¤§IDå–å¾—
   Location: server/index.js (119-123è¡Œç›®)
   Query: SELECT MAX(id) as max_id FROM patients
   Response: { maxId: 1233 }
   â†“
5. æ¬¡ã®IDã‚’ç”»é¢ã«è¡¨ç¤º
   State: suggestedId = "1234"
   Display: "æ‚£è€…ID: è‡ªå‹• 1234"
   â†“
6. ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒæƒ…å ±å…¥åŠ›
   - åå‰: "å±±ç”°å¤ªéƒ"
   - ãµã‚ŠãŒãª: "ã‚„ã¾ã ãŸã‚ã†"
   - ç”Ÿå¹´æœˆæ—¥: "1980-01-01"
   - æ€§åˆ¥: "ç”·æ€§"
   - é›»è©±ç•ªå·: "090-1234-5678"
   - ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹: "yamada@example.com"
   - ä½æ‰€: "æ±äº¬éƒ½..."
   - ç·Šæ€¥é€£çµ¡å…ˆ: "090-9876-5432"
   - æ—¢å¾€æ­´: "é«˜è¡€åœ§"
   - ã‚¢ãƒ¬ãƒ«ã‚®ãƒ¼: "ãªã—"
   â†“
7. ç™»éŒ²ãƒœã‚¿ãƒ³ã‚¯ãƒªãƒƒã‚¯
   â†“
8. ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³
   - å¿…é ˆé …ç›®ãƒã‚§ãƒƒã‚¯ï¼ˆåå‰ã€ç”Ÿå¹´æœˆæ—¥ã€é›»è©±ç•ªå·ï¼‰
   - å½¢å¼ãƒã‚§ãƒƒã‚¯ï¼ˆãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã€é›»è©±ç•ªå·ï¼‰
   â†“
9. APIã‚³ãƒ¼ãƒ«
   POST /api/patients
   Header: Authorization: Bearer <token>
   Body: { name, kana, birth_date, ... }
   â†“
10. ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã§ç™»éŒ²å‡¦ç†
    Location: server/index.js (125-147è¡Œç›®)
    Query: INSERT INTO patients (...) VALUES (...) RETURNING id
    â†“
11. ç™»éŒ²å®Œäº†
    Response: { id: 1234, message: "æ‚£è€…ãŒæ­£å¸¸ã«ç™»éŒ²ã•ã‚Œã¾ã—ãŸ" }
    â†“
12. æ‚£è€…ä¸€è¦§ã«ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆ
    navigate('/patients')
```

### ã‚«ãƒ«ãƒ†ä½œæˆãƒ•ãƒ­ãƒ¼ï¼ˆå®Œäº†ï¼‰âœ…

```
1. æ‚£è€…è©³ç´°ç”»é¢ã‹ã‚‰ã€Œã‚«ãƒ«ãƒ†ä½œæˆã€ã‚’ã‚¯ãƒªãƒƒã‚¯
   Location: client/src/components/PatientDetail.tsx
   â†“
2. ã‚«ãƒ«ãƒ†ä½œæˆç”»é¢è¡¨ç¤º
   Location: client/src/components/AddMedicalRecord.tsx
   URL: /patients/:id/records/add
   â†“
3. useEffectã§æ‚£è€…æƒ…å ±å–å¾—
   GET /api/patients/:id
   Header: Authorization: Bearer <token>
   â†“
4. æ‚£è€…æƒ…å ±è¡¨ç¤º
   Display: "æ‚£è€…: å±±ç”°å¤ªéƒ (ID: 1234)"
   â†“
5. ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒæ–½è¡“æƒ…å ±å…¥åŠ›
   - æ–½è¡“æ—¥: "2025-10-22"
   - æ–½è¡“ç¨®é¡: "é¼æ²»ç™‚"
   - ç—‡çŠ¶: "è‚©ã“ã‚Šã€é ­ç—›"
   - è¨ºæ–­: "é ¸è‚©è…•ç—‡å€™ç¾¤"
   - æ–½è¡“å†…å®¹: "è‚©äº•ã€å¤©æŸ±ã€é¢¨æ± ã«åˆºé¼"
   - å‚™è€ƒ: "æ¬¡å›ã¯1é€±é–“å¾Œ"
   â†“
6. å†™çœŸæ·»ä»˜ï¼ˆä»»æ„ï¼‰
   - ãƒ•ã‚¡ã‚¤ãƒ«é¸æŠ
   - ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼è¡¨ç¤º
   - Base64å¤‰æ›ï¼ˆç´„2MBï¼‰
   â†“
7. ç™»éŒ²ãƒœã‚¿ãƒ³ã‚¯ãƒªãƒƒã‚¯
   â†“
8. APIã‚³ãƒ¼ãƒ«
   POST /api/medical-records
   Header: Authorization: Bearer <token>
   Body: {
     patient_id: 1234,
     staff_id: 1,  // ãƒ­ã‚°ã‚¤ãƒ³ä¸­ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼
     treatment_date: "2025-10-22",
     treatment_type: "é¼æ²»ç™‚",
     symptoms: "è‚©ã“ã‚Šã€é ­ç—›",
     diagnosis: "é ¸è‚©è…•ç—‡å€™ç¾¤",
     treatment_content: "è‚©äº•ã€å¤©æŸ±ã€é¢¨æ± ã«åˆºé¼",
     notes: "æ¬¡å›ã¯1é€±é–“å¾Œ",
     photo: "data:image/jpeg;base64,/9j/4AAQ..."  // Base64
   }
   â†“
9. ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã§ç™»éŒ²å‡¦ç†
   Location: server/index.js (151-180è¡Œç›®ä»˜è¿‘)
   Query: INSERT INTO medical_records (...) VALUES (...) RETURNING id
   â†“
10. ç™»éŒ²å®Œäº†
    Response: { id: 5678, message: "ã‚«ãƒ«ãƒ†ãŒæ­£å¸¸ã«ä½œæˆã•ã‚Œã¾ã—ãŸ" }
    â†“
11. æ‚£è€…è©³ç´°ç”»é¢ã«æˆ»ã‚‹
    navigate(`/patients/${patientId}`)
```

### APIèªè¨¼ãƒ•ãƒ­ãƒ¼ï¼ˆå…¨APIã§å…±é€šï¼‰âœ…

```
1. ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã‹ã‚‰APIã‚³ãƒ¼ãƒ«
   Header: Authorization: Bearer eyJhbGc...
   â†“
2. ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã®ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢
   Location: server/index.js (authenticateTokené–¢æ•°)
   â†“
3. ãƒˆãƒ¼ã‚¯ãƒ³æ¤œè¨¼
   - Headerç¢ºèª: Authorizationå­˜åœ¨ãƒã‚§ãƒƒã‚¯
   - ãƒˆãƒ¼ã‚¯ãƒ³æŠ½å‡º: Bearer <token>ã‹ã‚‰tokenã‚’å–å¾—
   - JWTæ¤œè¨¼: jwt.verify(token, JWT_SECRET)
   â†“
4. æ¤œè¨¼çµæœ
   OK: req.user = { id, username, role }
   NG: res.status(401).json({ error: 'èªè¨¼ãŒå¿…è¦ã§ã™' })
   â†“
5. ãƒãƒ³ãƒ‰ãƒ©ãƒ¼å®Ÿè¡Œ
   - req.userã‹ã‚‰ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±å–å¾—
   - ãƒ­ãƒ¼ãƒ«ç¢ºèªï¼ˆå¿…è¦ã«å¿œã˜ã¦ï¼‰
   - DBå‡¦ç†
   - ãƒ¬ã‚¹ãƒãƒ³ã‚¹è¿”å´
```

### ç”»é¢é·ç§»ãƒ•ãƒ­ãƒ¼

```
/login (ãƒ­ã‚°ã‚¤ãƒ³ç”»é¢)
  â†’ ãƒ­ã‚°ã‚¤ãƒ³æˆåŠŸ
  â†“
/dashboard (ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰)
  â”œâ†’ æ‚£è€…ç®¡ç†
  â”‚  â”œâ†’ /patients (æ‚£è€…ä¸€è¦§)
  â”‚  â”‚  â”œâ†’ /patients/add (æ‚£è€…ç™»éŒ²)
  â”‚  â”‚  â””â†’ /patients/:id (æ‚£è€…è©³ç´°)
  â”‚  â”‚     â”œâ†’ /patients/:id/edit (æ‚£è€…ç·¨é›†)
  â”‚  â”‚     â”œâ†’ /patients/:id/records/add (ã‚«ãƒ«ãƒ†ä½œæˆ)
  â”‚  â”‚     â””â†’ /patients/:id/treatment (æ–½è¡“è¨˜éŒ²)
  â”‚  â”‚
  â”‚  â””â†’ /medical-records (ã‚«ãƒ«ãƒ†ä¸€è¦§)
  â”‚     â””â†’ /medical-records/:id/edit (ã‚«ãƒ«ãƒ†ç·¨é›†)
  â”‚
  â”œâ†’ æ–½è¡“ç®¡ç†
  â”‚  â”œâ†’ /menu-management (æ–½è¡“ãƒ¡ãƒ‹ãƒ¥ãƒ¼ç®¡ç†)
  â”‚  â””â†’ /therapists (æ–½è¡“è€…ç®¡ç†)
  â”‚     â”œâ†’ /therapists/add (æ–½è¡“è€…ç™»éŒ²)
  â”‚     â””â†’ /therapists/edit/:id (æ–½è¡“è€…ç·¨é›†)
  â”‚
  â”œâ†’ ç®¡ç†æ©Ÿèƒ½ï¼ˆãƒã‚¹ã‚¿ãƒ¼ã®ã¿ï¼‰
  â”‚  â”œâ†’ /receipts (é ˜åæ›¸ç®¡ç†)
  â”‚  â”œâ†’ /employees (å¾“æ¥­å“¡ç®¡ç†)
  â”‚  â”œâ†’ /wage-calculation (çµ¦ä¸è¨ˆç®—)
  â”‚  â”œâ†’ /workflow (ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ç®¡ç†)
  â”‚  â”œâ†’ /message-editor (ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ)
  â”‚  â”œâ†’ /line-bot (LINE Botç®¡ç†)
  â”‚  â”œâ†’ /backup (ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ç®¡ç†)
  â”‚  â”œâ†’ /reports (ãƒ¬ãƒãƒ¼ãƒˆ)
  â”‚  â””â†’ /settings (è¨­å®š)
  â”‚
  â””â†’ /logout (ãƒ­ã‚°ã‚¢ã‚¦ãƒˆ)
```

---

## ğŸ“ é–‹ç™ºãƒ¡ãƒ¢

### æœ€è¿‘ã®å¤‰æ›´å±¥æ­´

| æ—¥æ™‚ | ã‚³ãƒŸãƒƒãƒˆ | å¤‰æ›´å†…å®¹ |
|------|---------|---------|
| 2025/10/22 21:08 | 93def89 | PR#5ãƒãƒ¼ã‚¸: react-pro-sidebarå‰Šé™¤ |
| 2025/10/22 18:00 | 0259075 | package.jsonã‹ã‚‰react-pro-sidebarå‰Šé™¤ |
| 2025/10/22 17:00 | 9762ee9 | ã‚«ã‚¹ã‚¿ãƒ ã‚µã‚¤ãƒ‰ãƒãƒ¼å®Ÿè£… |
| 2025/10/22 16:00 | eea0951 | z-indexèª¿æ•´ |

### æ—¢çŸ¥ã®å•é¡Œ

1. **ã‚µã‚¤ãƒ‰ãƒãƒ¼è¡¨ç¤ºå•é¡Œ** (2025/10/22 21:00)
   - ç—‡çŠ¶: ãƒ–ãƒ©ã‚¦ã‚¶ãŒå¤ã„JSãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿è¾¼ã‚“ã§ã„ã‚‹
   - å½±éŸ¿: ã‚µã‚¤ãƒ‰ãƒãƒ¼ãŒå¸¸ã«è¡¨ç¤ºã•ã‚Œã‚‹
   - èª¿æŸ»ä¸­

2. **ç”»åƒå®¹é‡å•é¡Œ**
   - Base64å½¢å¼ã§ç´„2MB/æš
   - DBå®¹é‡1GBã§ç´„500æšãŒé™ç•Œ
   - è§£æ±ºç­–: ç”»åƒåœ§ç¸®ã¾ãŸã¯S3ç§»è¡Œ

3. **ã‚¹ãƒªãƒ¼ãƒ—å•é¡Œ**
   - 15åˆ†ç„¡é€šä¿¡ã§ã‚¹ãƒªãƒ¼ãƒ—
   - è§£æ±ºç­–: UptimeRobotå°å…¥

---

## ğŸ”§ é–‹ç™ºç’°å¢ƒã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

### ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰

```bash
cd ~/Projects/myapp/client
npm install
npm start  # http://localhost:3000
```

### ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰

```bash
cd ~/Projects/myapp/server
npm install

# .envãƒ•ã‚¡ã‚¤ãƒ«ä½œæˆ
echo "DATABASE_URL=postgresql://user:pass@host:5432/db" > .env
echo "JWT_SECRET=your-secret-key" >> .env

node api-server.js  # http://localhost:5000
```

### ãƒ‡ãƒ—ãƒ­ã‚¤

```bash
# GitHubã«ãƒ—ãƒƒã‚·ãƒ¥ã™ã‚‹ã ã‘ã§è‡ªå‹•ãƒ‡ãƒ—ãƒ­ã‚¤
git add .
git commit -m "feat: æ–°æ©Ÿèƒ½è¿½åŠ "
git push origin main

# VercelãŒè‡ªå‹•çš„ã«ãƒ“ãƒ«ãƒ‰ãƒ»ãƒ‡ãƒ—ãƒ­ã‚¤
# Renderã‚‚mainãƒ–ãƒ©ãƒ³ãƒã®å¤‰æ›´ã‚’æ¤œçŸ¥ã—ã¦è‡ªå‹•ãƒ‡ãƒ—ãƒ­ã‚¤
```

---

## ğŸ“ ã‚µãƒãƒ¼ãƒˆ

### ãƒªãƒã‚¸ãƒˆãƒª
https://github.com/ryosukekambara/karusaku-emr

### é–‹ç™ºè€…
Ryosuke Kambara

### ãƒ©ã‚¤ã‚»ãƒ³ã‚¹
Private

---

**æœ€çµ‚æ›´æ–°**: 2025å¹´10æœˆ22æ—¥ 21:00
